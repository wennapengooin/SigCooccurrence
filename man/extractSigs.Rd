% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extractSigs.R
\name{extractSigs}
\alias{extractSigs}
\title{Extract or Fit Mutational Signatures}
\usage{
extractSigs(
  muts_grl,
  type = c("SNV", "DBS", "INDEL"),
  genome,
  mode = c("de_novo", "fit_to_cosmic"),
  n_de_novo = NULL,
  nmf_nrun = 100,
  cosmic_version = NULL
)
}
\arguments{
\item{muts_grl}{A \code{GRangesList} object, \strong{pre-filtered} by
\code{filterMuts} for a single mutation type (e.g., "SNV").}

\item{type}{A character string specifying the mutation type. Must match
the filtering used to create \code{muts_grl}. One of "SNV", "DBS",
or "INDEL". (Case-insensitive)}

\item{genome}{A character string specifying the reference genome
(e.g., "hg19" or "hg38"). Must match the one used in \code{importMuts}.}

\item{mode}{A character string specifying the analysis mode. One of:
\itemize{
\item \code{"de_novo"}: Extract \code{n_de_novo} new signatures.
\item \code{"fit_to_cosmic"}: Fit known COSMIC signatures.
}}

\item{n_de_novo}{An integer. Required only if \code{mode = "de_novo"}.
Specifies the. number of signatures to extract (the NMF rank).}

\item{nmf_nrun}{An integer. Optional, for \code{mode = "de_novo"} only.
Specifies the number of NMF runs. Defaults to 100 for stability.
(Note: Test scripts may use \code{nmf_nrun = 1} for speed).}

\item{cosmic_version}{A character string specifying the COSMIC signature
version to use. Required only if \code{mode = "fit_to_cosmic"}.
\itemize{
\item For "SNV": "v3.1", "v3.2" (default: "v3.2")
\item For "DBS": "v3.2" (default: "v3.2")
\item For "INDEL": "v3.1" (default: "v3.1")
}}
}
\value{
A list containing the results of the NMF or fitting,
as returned by \code{MutationalPatterns}. This list includes
\code{signatures} (the signature profiles) and \code{contribution}
(the exposure matrix, with signatures in rows and samples in columns).
}
\description{
This function serves two modes:
\enumerate{
\item \strong{"de_novo"}: Extracts a specified number of \emph{de novo} mutational
signatures from a mutation count matrix using NMF.
\item \strong{"fit_to_cosmic"}: Fits known COSMIC mutational signatures to a
mutation count matrix to find the optimal exposure (contribution)
of each signature in each sample.
}
}
\details{
This function is a wrapper for core functions from the \code{MutationalPatterns}
package. It first builds the appropriate mutation count matrix
(e.g., 96-channel for SNV) from the provided \code{muts_grl}. It then
performs one of the two modes.

The output is a list containing the results. For signature co-occurrence
analysis, you will be most interested in the \code{contribution} matrix
(exposures) from the result.
}
\examples{
\dontrun{
  # --- Setup ---
  muts_grl <- importMuts(vcf_files, genome = "hg19")
  snv_grl <- filterMuts(muts_grl, type = "SNV")

  # --- Example 1: Fit to COSMIC v3.2 SBS signatures ---
  fit_res <- extractSigs(
    snv_grl,
    type = "SNV",
    genome = "hg19",
    mode = "fit_to_cosmic",
    cosmic_version = "v3.2"
  )
  # Get the exposure matrix for the next step
  exposures <- fit_res$contribution

  # --- Example 2: Extract 5 de novo SBS signatures ---
  # This requires more samples and mutations to be stable
  de_novo_res <- extractSigs(
    snv_grl,
    type = "SNV",
    genome = "hg19",
    mode = "de_novo",
    n_de_novo = 5,
    nmf_nrun = 100 # Use more runs for a real analysis
  )
  # Get the de novo exposure matrix
  de_novo_exposures <- de_novo_res$contribution
}
}
\references{
Alexandrov, L.B. et al. (2020). The repertoire of mutational signatures in
human cancer. \emph{Nature}, 578, 94–101.
\href{https://doi.org/10.1038/s41586-020-1943-3}{Link}

Gaujoux R, Seoighe C, Sauwen N (2024). The package NMF: manual pages.
\emph{R package version 0.28}. \href{https://cran.r-project.org/package=NMF}{Link}

Manders, F., Brandsma, A.M., de Kanter, J. et al. (2022).
MutationalPatterns: the one stop shop for the analysis of mutational
processes. \emph{BMC Genomics}, 23, 134.
\href{https://doi.org/10.1186/s12864-022-08357-3}{Link}

Pagès, H. (2025). BSgenome: Software infrastructure for efficient
representation of full genomes and their SNPs. \emph{R package version 1.78.0}.
\href{https://bioconductor.org/packages/BSgenome}{Link}
}
